From 9e71176fbaa07ca33a8c8b5ad37ebbd612595534 Mon Sep 17 00:00:00 2001
From: Yaroslav Zviezda <acroreiser@gmail.com>
Date: Wed, 29 Dec 2021 11:34:32 +0300
Subject: [PATCH 3/3] sepolicy: allow ignoring neverallows in user builds

Change-Id: Id49e13e6168ce3b638845c61a2bb51fb0e81d7d3
---
 Android.mk | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/Android.mk b/Android.mk
index 32cee136b..528450371 100644
--- a/Android.mk
+++ b/Android.mk
@@ -69,12 +69,13 @@ endif
 
 ifeq ($(SELINUX_IGNORE_NEVERALLOWS),true)
 ifeq ($(TARGET_BUILD_VARIANT),user)
-$(error SELINUX_IGNORE_NEVERALLOWS := true cannot be used in user builds)
-endif
+$(warning SELINUX_IGNORE_NEVERALLOWS := true must not be used in retail user builds)
+else
 $(warning Be careful when using the SELINUX_IGNORE_NEVERALLOWS flag. \
           It does not work in user builds and using it will \
           not stop you from failing CTS.)
 endif
+endif
 
 # BOARD_SEPOLICY_DIRS was used for vendor/odm sepolicy customization before.
 # It has been replaced by BOARD_VENDOR_SEPOLICY_DIRS (mandatory) and
-- 
2.45.2

