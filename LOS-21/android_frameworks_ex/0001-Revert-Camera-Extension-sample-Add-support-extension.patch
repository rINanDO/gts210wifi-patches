From a194616bde55f8a3eb1e786fb964882ce233cf7d Mon Sep 17 00:00:00 2001
From: html6405 <peter.schelchshorn@mhs-solutions.at>
Date: Wed, 27 Dec 2023 19:28:57 +0100
Subject: [PATCH] Revert "Camera Extension sample: Add support extension
 specific metadata"

This reverts commit f606f73079afcd17457a828716c127b84533beb3.
---
 .../impl/HdrImageCaptureExtenderImpl.java        | 16 ++--------------
 .../extensions/impl/HdrPreviewExtenderImpl.java  |  9 ---------
 2 files changed, 2 insertions(+), 23 deletions(-)

diff --git a/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrImageCaptureExtenderImpl.java b/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrImageCaptureExtenderImpl.java
index 2523263..6988ab8 100644
--- a/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrImageCaptureExtenderImpl.java
+++ b/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrImageCaptureExtenderImpl.java
@@ -17,7 +17,6 @@ package androidx.camera.extensions.impl;
 
 import android.content.Context;
 import android.hardware.camera2.CameraCharacteristics;
-import android.hardware.camera2.CameraExtensionCharacteristics;
 import android.hardware.camera2.CaptureRequest;
 import android.hardware.camera2.CaptureResult;
 import android.hardware.camera2.TotalCaptureResult;
@@ -206,16 +205,6 @@ public final class HdrImageCaptureExtenderImpl implements ImageCaptureExtenderIm
                                             jpegOrientation));
                                 }
 
-                                Integer strength = result.second.get(
-                                        CaptureResult.EXTENSION_STRENGTH);
-                                if (strength != null) {
-                                    captureResults.add(new Pair<>(CaptureResult.EXTENSION_STRENGTH,
-                                            strength));
-                                }
-
-                                captureResults.add(new Pair<>(CaptureResult.EXTENSION_CURRENT_TYPE,
-                                            CameraExtensionCharacteristics.EXTENSION_HDR));
-
                                 if (executor != null) {
                                     executor.execute(() -> resultCallback.onCaptureCompleted(
                                             shutterTimestamp, captureResults));
@@ -385,7 +374,7 @@ public final class HdrImageCaptureExtenderImpl implements ImageCaptureExtenderIm
     public List<CaptureRequest.Key> getAvailableCaptureRequestKeys() {
         final CaptureRequest.Key [] CAPTURE_REQUEST_SET = {CaptureRequest.CONTROL_ZOOM_RATIO,
             CaptureRequest.CONTROL_AF_MODE, CaptureRequest.CONTROL_AF_REGIONS,
-            CaptureRequest.CONTROL_AF_TRIGGER, CaptureRequest.EXTENSION_STRENGTH};
+            CaptureRequest.CONTROL_AF_TRIGGER};
         return Arrays.asList(CAPTURE_REQUEST_SET);
     }
 
@@ -393,8 +382,7 @@ public final class HdrImageCaptureExtenderImpl implements ImageCaptureExtenderIm
     public List<CaptureResult.Key> getAvailableCaptureResultKeys() {
         final CaptureResult.Key [] CAPTURE_RESULT_SET = {CaptureResult.CONTROL_ZOOM_RATIO,
             CaptureResult.CONTROL_AF_MODE, CaptureResult.CONTROL_AF_REGIONS,
-            CaptureResult.CONTROL_AF_TRIGGER, CaptureResult.CONTROL_AF_STATE,
-            CaptureResult.EXTENSION_CURRENT_TYPE, CaptureResult.EXTENSION_STRENGTH};
+            CaptureResult.CONTROL_AF_TRIGGER, CaptureResult.CONTROL_AF_STATE};
         return Arrays.asList(CAPTURE_RESULT_SET);
     }
 
diff --git a/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrPreviewExtenderImpl.java b/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrPreviewExtenderImpl.java
index 7777bfa..eb51390 100644
--- a/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrPreviewExtenderImpl.java
+++ b/camera2/extensions/sample/src/java/androidx/camera/extensions/impl/HdrPreviewExtenderImpl.java
@@ -18,7 +18,6 @@ package androidx.camera.extensions.impl;
 
 import android.content.Context;
 import android.hardware.camera2.CameraCharacteristics;
-import android.hardware.camera2.CameraExtensionCharacteristics;
 import android.hardware.camera2.CaptureResult;
 import android.hardware.camera2.TotalCaptureResult;
 import android.hardware.camera2.params.MeteringRectangle;
@@ -195,14 +194,6 @@ public final class HdrPreviewExtenderImpl implements PreviewExtenderImpl {
                                 jpegOrientation));
                     }
 
-                    Integer strength = result.get(CaptureResult.EXTENSION_STRENGTH);
-                    if (strength != null) {
-                        captureResults.add(new Pair<>(CaptureResult.EXTENSION_STRENGTH, strength));
-                    }
-
-                    captureResults.add(new Pair<>(CaptureResult.EXTENSION_CURRENT_TYPE,
-                                CameraExtensionCharacteristics.EXTENSION_HDR));
-
                     if (executor != null) {
                         executor.execute(() -> resultCallback.onCaptureCompleted(shutterTimestamp,
                                 captureResults));
-- 
2.45.2

